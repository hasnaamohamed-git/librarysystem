<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library Admin Dashboard & Analytics</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        :root {
            --primary: #1e3a5f;
            --accent: #8b7355;
            --light: #f5f1e8;
            --border: #e8dcc8;
            --nav-bg: #2c5282;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--light);
            color: var(--primary);
            line-height: 1.6;
        }
        .container { max-width: 1450px; margin: 0 auto; padding: 20px; }

        /* Top Navigation Bar - Blue Background */
        .top-bar {
            background: var(--nav-bg);
            padding: 16px 30px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(44, 82, 130, 0.3);
        }
        
        /* Left side: Profile and Notification */
        .left-nav {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .profile-circle {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background: white;
            color: var(--nav-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .profile-circle:hover {
            transform: scale(1.05);
        }
        
        .notification {
            font-size: 22px;
            color: white;
            position: relative;
            cursor: pointer;
            padding: 8px;
        }
        .notification-badge {
            position: absolute;
            top: 2px;
            right: 2px;
            background: #ff4757;
            color: white;
            font-size: 11px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        /* Center: Search bar */
        .search-bar {
            flex: 1;
            max-width: 500px;
            margin: 0 30px;
        }
        .search-bar input {
            width: 100%;
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            font-size: 15px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
        }
        .search-bar input:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.5);
        }
        .search-bar input::placeholder {
            color: #666;
        }
        
        /* Right side: Logo and Menu */
        .right-nav {
            display: flex;
            align-items: center;
            gap: 25px;
        }
        
        .logo {
            font-size: 28px;
            background: white;
            color: var(--nav-bg);
            width: 45px;
            height: 45px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .menu-toggle {
            font-size: 28px;
            color: white;
            cursor: pointer;
            padding: 8px;
            transition: transform 0.2s;
        }
        .menu-toggle:hover {
            transform: scale(1.1);
        }

        /* Header - No Background */
        .header {
            margin-bottom: 30px;
        }
        .header h1 { 
            font-size: 36px; 
            margin-bottom: 8px; 
            font-weight: 800; 
            color: var(--primary);
        }
        .header p { 
            color: var(--accent); 
            font-size: 17px; 
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 22px;
            margin-bottom: 32px;
        }
        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 6px 16px rgba(30,58,95,0.12);
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }
        .stat-card:hover { transform: translateY(-6px); box-shadow: 0 14px 28px rgba(30,58,95,0.18); }

        .stat-title {
            font-size: 19px;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }
        .stat-title .emoji { font-size: 32px; }
        .stat-value { font-size: 34px; font-weight: 800; color: var(--primary); }
        .stat-sub { font-size: 15px; color: var(--accent); margin-top: 6px; font-weight: 600; }
        .progress-container { margin-top: 14px; }
        .progress-bar { height: 10px; background: #e0d5c5; border-radius: 6px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--primary); width: 0; border-radius: 6px; transition: width 1.4s ease; }

        /* Collapsible Sections */
        .section-toggle {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 6px 16px rgba(30,58,95,0.12);
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.3s;
        }
        .section-toggle:hover { box-shadow: 0 12px 24px rgba(30,58,95,0.18); }
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .section-header h2 {
            font-size: 22px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .arrow { font-size: 28px; transition: transform 0.4s; color: var(--primary); }
        .arrow.open { transform: rotate(90deg); }
        .section-content { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-out; }
        .section-content.open { max-height: 4000px; padding-top: 28px; }

        /* Charts & Widgets */
        .charts-row, .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(520px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }
        .chart-card, .widget-card {
            background: white;
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 6px 16px rgba(30,58,95,0.12);
            border: 1px solid var(--border);
        }
        .chart-card h2, .widget-card h2 {
            font-size: 21px;
            margin-bottom: 20px;
            font-weight: 700;
            color: var(--primary);
        }
        .chart-container { position: relative; height: 340px; }

        select {
            padding: 10px 16px;
            border: 2px solid var(--border);
            border-radius: 10px;
            background: white;
            font-size: 15px;
            cursor: pointer;
            margin-bottom: 16px;
        }

        /* Popular Books Tabs */
        .tab-buttons {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border);
        }
        .tab-btn {
            padding: 10px 20px;
            background: none;
            border: none;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        .tab-btn.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }
        .book-item {
            display: flex;
            justify-content: space-between;
            padding: 14px 0;
            border-bottom: 1px solid #f0ece2;
        }
        .book-item:last-child { border-bottom: none; }
        .book-rank { font-weight: bold; color: var(--accent); width: 32px; }
        .book-title { flex: 1; font-weight: 500; }
        .book-count { font-weight: 600; color: var(--primary); }

        /* Category Breakdown */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 24px;
        }
        .category-item {
            padding: 16px;
            background: #f9f5f0;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .category-name { font-weight: 600; }
        .category-percent { font-weight: 700; color: var(--primary); }

        /* Legend */
        .legend-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            background: var(--light);
            border-radius: 10px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .legend-item:hover { background: #e0d5c5; }
        .legend-item.active { background: var(--primary); color: white; }
        .legend-color { width: 18px; height: 18px; border-radius: 6px; margin-right: 12px; }

        /* Activity Items */
        .activity-item {
            padding: 16px;
            background: #f9f5f0;
            border-radius: 12px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .activity-icon { font-size: 20px; }
        .activity-time { margin-left: auto; color: var(--accent); font-size: 14px; }

        /* Metrics Cards */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }
        .metric-card {
            background: #f9f5f0;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        .metric-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }
        .metric-label {
            font-size: 14px;
            color: var(--accent);
            font-weight: 600;
        }

        /* AI Chatbot Floating Widget */
        .chatbot-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .chatbot-toggle {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), #2c5282);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(30, 58, 95, 0.3);
            border: 3px solid white;
            transition: all 0.3s ease;
            position: relative;
        }

        .chatbot-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(30, 58, 95, 0.4);
        }

        .chatbot-toggle.minimized {
            width: 70px;
            height: 70px;
        }

        .chatbot-toggle .close-btn {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 25px;
            height: 25px;
            background: #ff4757;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .chatbot-toggle:hover .close-btn {
            opacity: 1;
        }

        .chatbot-window {
            position: absolute;
            bottom: 85px;
            right: 0;
            width: 380px;
            height: 520px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(30, 58, 95, 0.25);
            border: 2px solid var(--border);
            display: none;
            flex-direction: column;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .chatbot-window.open {
            display: flex;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chatbot-header {
            background: linear-gradient(to right, var(--primary), #2c5282);
            color: white;
            padding: 18px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
        }

        .chatbot-header h3 {
            font-size: 18px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chatbot-header .close-chat {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            transition: background 0.3s;
        }

        .chatbot-header .close-chat:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .chatbot-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #fcfaf6;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.4;
            font-size: 14px;
        }

        .bot-message {
            background: #e8f2ff;
            border-bottom-left-radius: 5px;
            align-self: flex-start;
            color: var(--primary);
            border: 1px solid #d1e3ff;
        }

        .user-message {
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 5px;
            align-self: flex-end;
        }

        .chatbot-input {
            padding: 20px;
            border-top: 1px solid var(--border);
            background: white;
            display: flex;
            gap: 10px;
        }

        .chatbot-input input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 25px;
            font-size: 14px;
            outline: none;
            transition: border 0.3s;
        }

        .chatbot-input input:focus {
            border-color: var(--primary);
        }

        .chatbot-input button {
            background: var(--primary);
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            transition: background 0.3s;
        }

        .chatbot-input button:hover {
            background: #2c5282;
        }

        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 10px 16px;
            background: #e8f2ff;
            border-radius: 18px;
            border-bottom-left-radius: 5px;
            align-self: flex-start;
            width: fit-content;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--primary);
            border-radius: 50%;
            opacity: 0.6;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.6; }
            30% { transform: translateY(-6px); opacity: 1; }
        }

        @media (max-width: 768px) {
            .charts-row, .content-grid { grid-template-columns: 1fr; }
            .categories-grid { grid-template-columns: 1fr; }
            .top-bar { flex-direction: column; gap: 15px; padding: 15px; }
            .left-nav, .right-nav { width: 100%; justify-content: space-between; }
            .search-bar { margin: 15px 0; max-width: 100%; }
            .chatbot-window {
                width: 320px;
                height: 450px;
                right: 10px;
                bottom: 80px;
            }
            .chatbot-toggle {
                width: 60px;
                height: 60px;
                font-size: 24px;
                bottom: 20px;
                right: 20px;
            }
        }

        @media (max-width: 480px) {
            .chatbot-window {
                width: 280px;
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Top Navigation Bar - Blue Background -->
        <div class="top-bar">
            <!-- Left: Profile and Notification -->
            <div class="left-nav">
                <div class="profile-circle">AJ</div>
                <div class="notification">
                    üîî
                    <span class="notification-badge">3</span>
                </div>
            </div>
            
            <!-- Center: Search bar -->
            <div class="search-bar">
                <input type="text" placeholder="Search books, members, or reports...">
            </div>
            
            <!-- Right: Logo and Menu -->
            <div class="right-nav">
                <div class="logo">üìö</div>
                <div class="menu-toggle">‚ò∞</div>
            </div>
        </div>

        <!-- Header - No Background -->
        <div class="header">
            <h1>Admin Dashboard</h1>
            <p>Welcome back! Here's what's happening today.</p>
        </div>

        <!-- Overview Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-title">Total Members <span class="emoji">üë•</span></div>
                <div class="stat-value">1,247</div>
                <div class="stat-sub">+5.2% this month</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Total Books <span class="emoji">üìö</span></div>
                <div class="stat-value">8,543</div>
                <div class="stat-sub">+12 added this week</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Books Borrowed <span class="emoji">üìñ</span></div>
                <div class="stat-value">342</div>
                <div class="stat-sub">4% of catalog</div>
                <div class="progress-container">
                    <div class="progress-bar"><div class="progress-fill"></div></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Active Reservations <span class="emoji">üìÖ</span></div>
                <div class="stat-value">89</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Total Revenue <span class="emoji">üí∞</span></div>
                <div class="stat-value">$12,450</div>
                <div class="stat-sub">+8.4% vs last month</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Outstanding Fines <span class="emoji">‚ö†Ô∏è</span></div>
                <div class="stat-value">$850</div>
            </div>
        </div>

        <!-- Popular Books Widget -->
        <div class="widget-card">
            <h2>Popular Books</h2>
            <div class="tab-buttons">
                <button class="tab-btn active" onclick="showTab('alltime')">All-Time</button>
                <button class="tab-btn" onclick="showTab('trending')">Trending Books of January</button>
                <button class="tab-btn" onclick="showTab('rated')">Highest Rated</button>
                <button class="tab-btn" onclick="showTab('category')">Category Breakdown</button>
            </div>
            
            <!-- All-Time -->
            <div id="alltime" class="tab-content">
                <div class="book-item"><span class="book-rank">1</span><span class="book-title">To Kill a Mockingbird</span><span class="book-count">428 borrows</span></div>
                <div class="book-item"><span class="book-rank">2</span><span class="book-title">1984</span><span class="book-count">392 borrows</span></div>
                <div class="book-item"><span class="book-rank">3</span><span class="book-title">Pride and Prejudice</span><span class="book-count">356 borrows</span></div>
                <div class="book-item"><span class="book-rank">4</span><span class="book-title">The Great Gatsby</span><span class="book-count">341 borrows</span></div>
                <div class="book-item"><span class="book-rank">5</span><span class="book-title">Atomic Habits</span><span class="book-count">318 borrows</span></div>
            </div>
            
            <!-- Trending (Current Month) -->
            <div id="trending" class="tab-content" style="display:none;">
                <div class="book-item"><span class="book-rank">1</span><span class="book-title">The Midnight Library</span><span class="book-count">42 borrows</span></div>
                <div class="book-item"><span class="book-rank">2</span><span class="book-title">Project Hail Mary</span><span class="book-count">38 borrows</span></div>
                <div class="book-item"><span class="book-rank">3</span><span class="book-title">Klara and the Sun</span><span class="book-count">35 borrows</span></div>
                <div class="book-item"><span class="book-rank">4</span><span class="book-title">Where the Crawdads Sing</span><span class="book-count">32 borrows</span></div>
                <div class="book-item"><span class="book-rank">5</span><span class="book-title">The Seven Husbands of Evelyn Hugo</span><span class="book-count">28 borrows</span></div>
            </div>
            
            <!-- Highest Rated -->
            <div id="rated" class="tab-content" style="display:none;">
                <div class="book-item"><span class="book-rank">1</span><span class="book-title">The Alchemist</span><span class="book-count">4.9‚òÖ (342 ratings)</span></div>
                <div class="book-item"><span class="book-rank">2</span><span class="book-title">Sapiens: A Brief History of Humankind</span><span class="book-count">4.8‚òÖ (298 ratings)</span></div>
                <div class="book-item"><span class="book-rank">3</span><span class="book-title">Educated</span><span class="book-count">4.8‚òÖ (276 ratings)</span></div>
                <div class="book-item"><span class="book-rank">4</span><span class="book-title">The Book Thief</span><span class="book-count">4.7‚òÖ (312 ratings)</span></div>
                <div class="book-item"><span class="book-rank">5</span><span class="book-title">The Nightingale</span><span class="book-count">4.7‚òÖ (289 ratings)</span></div>
            </div>
            
            <!-- Category Breakdown -->
            <div id="category" class="tab-content" style="display:none;">
                <div class="categories-grid">
                    <div class="category-item">
                        <span class="category-name">Mystery/Thriller</span>
                        <span class="category-percent">18%</span>
                    </div>
                    <div class="category-item">
                        <span class="category-name">Romance</span>
                        <span class="category-percent">15%</span>
                    </div>
                    <div class="category-item">
                        <span class="category-name">Sci-Fi/Fantasy</span>
                        <span class="category-percent">14%</span>
                    </div>
                    <div class="category-item">
                        <span class="category-name">Self-Help</span>
                        <span class="category-percent">12%</span>
                    </div>
                    <div class="category-item">
                        <span class="category-name">History</span>
                        <span class="category-percent">10%</span>
                    </div>
                    <div class="category-item">
                        <span class="category-name">Biography</span>
                        <span class="category-percent">9%</span>
                    </div>
                    <div class="category-item">
                        <span class="category-name">Business</span>
                        <span class="category-percent">14%</span>
                    </div>
                    <div class="category-item">
                        <span class="category-name">Children's</span>
                        <span class="category-percent">8%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Financial Charts -->
        <div class="charts-row">
            <div class="chart-card">
                <h2>Revenue Over Time</h2>
                <div class="chart-container"><canvas id="revenueChart"></canvas></div>
            </div>
            <div class="chart-card">
                <h2>Revenue by Category</h2>
                <select id="categoryDrillDown" onchange="updateCategoryChart()">
                    <option value="all">All Categories</option>
                    <option value="fiction">Fiction Subgenres</option>
                    <option value="nonfiction">Non-Fiction Subgenres</option>
                </select>
                <div style="display:flex; gap:20px; align-items:center;">
                    <div style="flex:1;"><canvas id="categoryChart"></canvas></div>
                    <div id="categoryLegend" style="flex:1;"></div>
                </div>
            </div>
        </div>

        <div class="charts-row">
            <!-- Monthly Comparison with Year Selector -->
            <div class="chart-card">
                <h2>Monthly Comparison</h2>
                <select id="yearDrillDown" onchange="updateMonthlyChart()">
                    <option value="2023">2023</option>
                    <option value="2024">2024</option>
                    <option value="2025" selected>2025</option>
                </select>
                <div class="chart-container"><canvas id="monthlyChart"></canvas></div>
            </div>
            <div class="chart-card">
                <h2>Rentals vs. Fines</h2>
                <div class="chart-container"><canvas id="rentalsFinesChart"></canvas></div>
            </div>
        </div>

        <!-- Member Analytics (Collapsible) -->
        <div class="section-toggle" onclick="toggleSection('member')">
            <div class="section-header">
                <h2>Member Analytics</h2>
                <span class="arrow" id="memberArrow">‚ñ∂</span>
            </div>
            <div class="section-content" id="memberContent">
                <div class="content-grid">
                    <div>
                        <h3 style="margin-bottom:16px; font-size:18px;">Most Active Members</h3>
                        <div class="activity-item">
                            <span class="activity-icon">üëë</span>
                            <div><strong>Sarah Johnson</strong> ‚Äî 28 books this year</div>
                            <span class="activity-time">Gold Tier</span>
                        </div>
                        <div class="activity-item">
                            <span class="activity-icon">ü•à</span>
                            <div><strong>Michael Chen</strong> ‚Äî 24 books this year</div>
                            <span class="activity-time">Silver Tier</span>
                        </div>
                        <div class="activity-item">
                            <span class="activity-icon">ü•â</span>
                            <div><strong>Emma Rodriguez</strong> ‚Äî 21 books this year</div>
                            <span class="activity-time">Silver Tier</span>
                        </div>
                        <div class="activity-item">
                            <span class="activity-icon">üìä</span>
                            <div><strong>David Park</strong> ‚Äî 19 books this year</div>
                            <span class="activity-time">Bronze Tier</span>
                        </div>
                        <div class="activity-item">
                            <span class="activity-icon">üìä</span>
                            <div><strong>Lisa Wang</strong> ‚Äî 18 books this year</div>
                            <span class="activity-time">Bronze Tier</span>
                        </div>
                    </div>
                    <div>
                        <!-- Member Engagement Metrics -->
                        <h3 style="margin-bottom:16px; font-size:18px;">Member Engagement Metrics</h3>
                        <div class="metrics-grid">
                            <div class="metric-card">
                                <div class="metric-value">71%</div>
                                <div class="metric-label">Active Members</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value">6.8</div>
                                <div class="metric-label">Avg. Books per Member</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value">3.2</div>
                                <div class="metric-label">Avg. Visits per Month</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value">82%</div>
                                <div class="metric-label">Renewal Rate</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Reading Patterns -->
                <h3 style="margin-top: 30px; margin-bottom: 16px;">Reading Patterns</h3>
                <div class="categories-grid">
                    <div class="category-item">
                        <span class="category-name">Avg. Reading Time per Book</span>
                        <span class="category-percent">14 days</span>
                    </div>
                    <div class="category-item">
                        <span class="category-name">Digital vs Physical Preference</span>
                        <span class="category-percent">65% / 35%</span>
                    </div>
                    <div class="category-item">
                        <span class="category-name">Series Completion Rate</span>
                        <span class="category-percent">42%</span>
                    </div>
                    <div class="category-item">
                        <span class="category-name">Peak Reading Hours</span>
                        <span class="category-percent">6-9 PM</span>
                    </div>
                    <div class="category-item">
                        <span class="category-name">Most Active Age Group</span>
                        <span class="category-percent">25-34 years</span>
                    </div>
                    <div class="category-item">
                        <span class="category-name">Weekend vs Weekday Activity</span>
                        <span class="category-percent">60% / 40%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Activity Log (Collapsible) -->
        <div class="section-toggle" onclick="toggleSection('activity')">
            <div class="section-header">
                <h2>Activity Log</h2>
                <span class="arrow" id="activityArrow">‚ñ∂</span>
            </div>
            <div class="section-content" id="activityContent">
                <h3 style="margin-bottom:16px; font-size:18px;">Recent Borrowings</h3>
                <div class="activity-item">
                    <span class="activity-icon">üìö</span>
                    <div><strong>Alice Cooper</strong> borrowed <em>The Great Gatsby</em></div>
                    <span class="activity-time">5 min ago</span>
                </div>
                <div class="activity-item">
                    <span class="activity-icon">üìö</span>
                    <div><strong>Bob Smith</strong> borrowed <em>Dune</em></div>
                    <span class="activity-time">27 min ago</span>
                </div>
                <div class="activity-item">
                    <span class="activity-icon">üìö</span>
                    <div><strong>Carol Davis</strong> borrowed <em>Becoming</em></div>
                    <span class="activity-time">1 hour ago</span>
                </div>
                
                <h3 style="margin-top: 30px; margin-bottom: 16px;">Recent Returns</h3>
                <div class="activity-item">
                    <span class="activity-icon">‚Ü™Ô∏è</span>
                    <div><strong>Ethan Moore</strong> returned <em>The Hobbit</em></div>
                    <span class="activity-time">15 min ago</span>
                </div>
                <div class="activity-item">
                    <span class="activity-icon">‚Ü™Ô∏è</span>
                    <div><strong>Fiona Green</strong> returned <em>Educated</em></div>
                    <span class="activity-time">2 hours ago</span>
                </div>
                
                <h3 style="margin-top: 30px; margin-bottom: 16px;">New Member Registrations</h3>
                <div class="activity-item">
                    <span class="activity-icon">‚ú®</span>
                    <div><strong>George Hill</strong> joined the library</div>
                    <span class="activity-time">Today, 10:42 AM</span>
                </div>
                <div class="activity-item">
                    <span class="activity-icon">‚ú®</span>
                    <div><strong>Hannah Lee</strong> joined the library</div>
                    <span class="activity-time">Yesterday, 4:15 PM</span>
                </div>
                
                <h3 style="margin-top: 30px; margin-bottom: 16px;">System Events</h3>
                <div class="activity-item">
                    <span class="activity-icon">‚öôÔ∏è</span>
                    <div>Database backup completed successfully</div>
                    <span class="activity-time">Today, 3:00 AM</span>
                </div>
                <div class="activity-item">
                    <span class="activity-icon">üìä</span>
                    <div>Monthly analytics report generated</div>
                    <span class="activity-time">Yesterday, 11:59 PM</span>
                </div>
                <div class="activity-item">
                    <span class="activity-icon">üîÑ</span>
                    <div>Catalog sync with ISBN database</div>
                    <span class="activity-time">Yesterday, 8:30 PM</span>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Chatbot Floating Widget -->
    <div class="chatbot-container">
        <div class="chatbot-toggle" id="chatbotToggle">
            <span>ü§ñ</span>
            <div class="close-btn" id="closeChatbot">√ó</div>
        </div>
        <div class="chatbot-window" id="chatbotWindow">
            <div class="chatbot-header">
                <h3><span>ü§ñ</span> Library AI Assistant</h3>
                <button class="close-chat" id="closeChat">√ó</button>
            </div>
            <div class="chatbot-messages" id="chatbotMessages">
                <div class="message bot-message">
                    Hello! I'm your Library AI Assistant. I can help with book recommendations, library information, and answer your questions about library services.
                </div>
                <div class="message bot-message">
                    Try asking me about popular books, opening hours, or borrowing policies!
                </div>
            </div>
            <div class="chatbot-input">
                <input type="text" id="chatbotInput" placeholder="Type your question here...">
                <button id="sendChatbotMessage">‚û§</button>
            </div>
        </div>
    </div>

    <script>
        // Get current month name
        const monthNames = ["January", "February", "March", "April", "May", "June",
                          "July", "August", "September", "October", "November", "December"];
        const currentMonth = monthNames[new Date().getMonth()];
        document.querySelector('.tab-buttons button:nth-child(2)').textContent = `Trending Books of ${currentMonth}`;

        // Revenue Over Time Chart
        new Chart(document.getElementById('revenueChart'), {
            type: 'line',
            data: {
                labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],
                datasets: [{
                    label: 'Revenue',
                    data: [8200,9100,10300,11200,10800,12450,13200,14100,13800,15000,14500,16200],
                    borderColor: '#1e3a5f',
                    backgroundColor: 'rgba(30,58,95,0.1)',
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } }
            }
        });

        // Yearly Data for Monthly Comparison
        const yearlyData = {
            2023: [7200,7800,8200,8900,8500,9200,9500,9800,9400,10000,9600,10200],
            2024: [8000,8800,9500,10400,10000,11500,12200,13000,12800,13800,13500,14800],
            2025: [8200,9100,10300,11200,10800,12450,13200,14100,13800,15000,14500,16200]
        };

        // Monthly Comparison Chart
        let monthlyChart = new Chart(document.getElementById('monthlyChart'), {
            type: 'line',
            data: {
                labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],
                datasets: [{
                    label: 'Revenue',
                    data: yearlyData[2025],
                    backgroundColor: 'rgba(30,58,95,0.2)',
                    borderColor: '#1e3a5f',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } }
            }
        });

        // Update Monthly Chart Function
        function updateMonthlyChart() {
            const year = document.getElementById('yearDrillDown').value;
            const data = yearlyData[year] || yearlyData[2025];
            monthlyChart.data.datasets[0].data = data;
            monthlyChart.update();
        }

        // Rentals vs Fines Chart
        new Chart(document.getElementById('rentalsFinesChart'), {
            type: 'bar',
            data: {
                labels: ['Jan','Feb','Mar','Apr','May','Jun'],
                datasets: [
                    {
                        label: 'Rentals',
                        data: [8500,9200,10100,10800,11500,12400],
                        backgroundColor: '#1e3a5f'
                    },
                    {
                        label: 'Fines',
                        data: [420,380,510,460,590,650],
                        backgroundColor: '#8b7355'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });

        // Category Chart Data
        const categoryData = {
            all: {
                labels: ['Mystery', 'Romance', 'Sci-Fi', 'Self-Help', 'History', 'Biography', 'Fantasy', 'Business'],
                data: [18,15,14,12,10,9,8,14],
                colors: ['#1e3a5f','#2d5a8f','#4a6fa5','#8b7355','#a5896a','#d4a574','#6789ba','#e8dcc8']
            },
            fiction: {
                labels: ['Mystery/Thriller', 'Romance', 'Sci-Fi', 'Fantasy', 'Historical', 'Literary'],
                data: [30,25,20,15,6,4],
                colors: ['#1e3a5f','#2d5a8f','#4a6fa5','#6789ba','#84a3cf','#9bb7e4']
            },
            nonfiction: {
                labels: ['Self-Help', 'Business', 'Memoirs', 'History', 'Science', 'Cookbooks'],
                data: [28,22,18,15,10,7],
                colors: ['#8b7355','#a5896a','#bc9f7f','#d3b594','#e8ccb9','#fadfc8']
            }
        };

        // Initialize Category Chart
        const catChart = new Chart(document.getElementById('categoryChart'), {
            type: 'doughnut',
            data: {
                labels: categoryData.all.labels,
                datasets: [{
                    data: categoryData.all.data,
                    backgroundColor: categoryData.all.colors,
                    borderWidth: 4,
                    borderColor: '#fff'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } }
            }
        });

        // Update Category Chart Function
        function updateCategoryChart() {
            const val = document.getElementById('categoryDrillDown').value;
            const data = categoryData[val] || categoryData.all;
            catChart.data.labels = data.labels;
            catChart.data.datasets[0].data = data.data;
            catChart.data.datasets[0].backgroundColor = data.colors;
            catChart.update();
            updateLegend(data);
        }

        // Update Legend Function
        function updateLegend(data) {
            document.getElementById('categoryLegend').innerHTML = data.labels.map((l,i) => `
                <div class="legend-item">
                    <div style="display:flex; align-items:center;">
                        <div class="legend-color" style="background:${data.colors[i]}"></div>
                        <span>${l}</span>
                    </div>
                    <span style="font-weight:600;">${data.data[i]}%</span>
                </div>
            `).join('');
        }

        // Initialize Legend
        updateLegend(categoryData.all);

        // Tabs Function
        function showTab(id) {
            document.querySelectorAll('.tab-content').forEach(el => el.style.display = 'none');
            document.getElementById(id).style.display = 'block';
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Toggle Sections Function
        function toggleSection(id) {
            const content = document.getElementById(id + 'Content');
            const arrow = document.getElementById(id + 'Arrow');
            content.classList.toggle('open');
            arrow.classList.toggle('open');
        }

        // Animate progress bars
        setTimeout(() => {
            document.querySelectorAll('.progress-fill').forEach(bar => bar.style.width = '4%');
        }, 600);

// Replace the chatbot response logic in the script section with this:

// Chatbot Functionality with better response matching
const chatbotToggle = document.getElementById('chatbotToggle');
const chatbotWindow = document.getElementById('chatbotWindow');
const closeChat = document.getElementById('closeChat');
const closeChatbot = document.getElementById('closeChatbot');
const sendButton = document.getElementById('sendChatbotMessage');
const chatbotInput = document.getElementById('chatbotInput');
const chatbotMessages = document.getElementById('chatbotMessages');

// Intelligent response database
const chatbotResponses = {
    greetings: [
        "Hello! How can I help you with library services today?",
        "Hi there! I'm your Library AI Assistant. What would you like to know?",
        "Welcome! I can help with book recommendations, library info, and more."
    ],
    help: [
        "I can help you with: book recommendations, library hours, borrowing policies, finding specific books, and library analytics.",
        "I'm here to help with library services, book suggestions, and answering questions about our collection.",
        "Ask me about popular books, opening hours, how to borrow books, or any other library-related questions!"
    ],
    hours: [
        "Our library is open Monday-Friday 8am-9pm, Saturday 9am-6pm, and Sunday 11am-5pm.",
        "Opening hours: Weekdays 8am-9pm, Saturday 9am-6pm, Sunday 11am-5pm.",
        "We're open 8am-9pm on weekdays, 9am-6pm Saturday, and 11am-5pm Sunday."
    ],
    borrowing: [
        "Members can borrow up to 10 items at once for 3 weeks, with the option to renew twice if no one else has reserved them.",
        "You can borrow 10 items maximum for 21 days. Renewals are available for most items.",
        "Borrowing policy: 10 items maximum, 3-week loan period, 2 renewals allowed."
    ],
    popular: [
        "Based on our analytics, the most popular book this month is 'The Midnight Library' with 42 borrows.",
        "The trending book right now is 'Project Hail Mary' with 38 borrows this month.",
        "Our most borrowed book this month is 'The Midnight Library'. Would you like more recommendations?"
    ],
    recommendations: [
        "If you like mysteries, I recommend 'The Silent Patient' or 'Gone Girl'.",
        "For sci-fi fans, try 'Project Hail Mary' or 'The Three-Body Problem'.",
        "If you enjoyed 'The Midnight Library', you might like 'The Invisible Life of Addie LaRue'."
    ],
    fines: [
        "Outstanding fines can be paid online through your member portal or at the front desk.",
        "You can pay fines online via your account or in person at the library. Current outstanding fines total $850.",
        "Fines can be paid online or at the circulation desk. The fine rate is $0.25 per day per overdue item."
    ],
    membership: [
        "We have 1,247 total members. New members can register online or in-person at the library. Registration is free!",
        "Membership is free! You can register online or visit us in person with ID proof.",
        "We currently have 1,247 active members. Registration takes 5 minutes and is completely free."
    ],
    revenue: [
        "The current total revenue is $12,450, which is up 8.4% compared to last month.",
        "Monthly revenue is $12,450, showing an 8.4% increase from last month.",
        "Our revenue analytics show $12,450 this month, an 8.4% growth from last month."
    ],
    stats: [
        "Current stats: 1,247 members, 8,543 books, 342 currently borrowed, 89 active reservations.",
        "Library statistics: 1,247 members, 8,543 books in collection, 342 books borrowed, $12,450 revenue.",
        "Here are our current stats: 1,247 members, 8,543 books, 342 borrowed items, 89 reservations."
    ],
    unknown: [
        "I'm not sure I understand. Could you rephrase that?",
        "I'm here to help with library-related questions. Try asking about books, hours, or policies.",
        "Could you ask that differently? I'm best at answering library and book-related questions."
    ]
};

// Function to determine the best response
function getAppropriateResponse(message) {
    const lowerMsg = message.toLowerCase();
    
    // Check for greeting patterns
    if (/(hi|hello|hey|greetings|good morning|good afternoon|good evening)/.test(lowerMsg)) {
        return getRandomResponse('greetings');
    }
    
    // Check for help requests
    if (/(help|what can you do|capabilities|features)/.test(lowerMsg)) {
        return getRandomResponse('help');
    }
    
    // Check for time/hours questions
    if (/(hour|open|close|time|when.*open|schedule)/.test(lowerMsg)) {
        return getRandomResponse('hours');
    }
    
    // Check for borrowing questions
    if (/(borrow|loan|rent|check out|take out|borrowing)/.test(lowerMsg)) {
        return getRandomResponse('borrowing');
    }
    
    // Check for popular book questions
    if (/(popular|trending|best.*seller|top.*book|most.*borrowed)/.test(lowerMsg)) {
        return getRandomResponse('popular');
    }
    
    // Check for recommendation requests
    if (/(recommend|suggest|what.*read|book.*idea)/.test(lowerMsg)) {
        return getRandomResponse('recommendations');
    }
    
    // Check for fines questions
    if (/(fine|fee|payment|pay.*fine|overdue|late)/.test(lowerMsg)) {
        return getRandomResponse('fines');
    }
    
    // Check for membership questions
    if (/(member|join|register|sign up|membership)/.test(lowerMsg)) {
        return getRandomResponse('membership');
    }
    
    // Check for revenue/money questions
    if (/(revenue|money|income|profit|earning|finance)/.test(lowerMsg)) {
        return getRandomResponse('revenue');
    }
    
    // Check for stats questions
    if (/(stat|number|count|total|how many|analytics|dashboard)/.test(lowerMsg)) {
        return getRandomResponse('stats');
    }
    
    // Check for simple acknowledgments
    if (/(ok|okay|thanks|thank you|cool|good|nice|alright)/.test(lowerMsg)) {
        return "Is there anything else I can help you with?";
    }
    
    // Check for "really" or confirmation questions
    if (/(really|are you sure|serious|true)/.test(lowerMsg)) {
        return "Yes, that's correct based on our current library data. Would you like more details?";
    }
    
    // Default response
    return getRandomResponse('unknown');
}

function getRandomResponse(category) {
    const responses = chatbotResponses[category];
    return responses[Math.floor(Math.random() * responses.length)];
}

// Toggle chatbot window
chatbotToggle.addEventListener('click', () => {
    chatbotWindow.classList.toggle('open');
});

// Close chat window
closeChat.addEventListener('click', () => {
    chatbotWindow.classList.remove('open');
});

// Close chatbot completely
closeChatbot.addEventListener('click', (e) => {
    e.stopPropagation();
    chatbotToggle.style.display = 'none';
    chatbotWindow.classList.remove('open');
});

// Send message function
function sendChatbotMessage() {
    const message = chatbotInput.value.trim();
    if (!message) return;

    // Add user message
    const userMessage = document.createElement('div');
    userMessage.className = 'message user-message';
    userMessage.textContent = message;
    chatbotMessages.appendChild(userMessage);

    // Clear input
    chatbotInput.value = '';

    // Scroll to bottom
    chatbotMessages.scrollTop = chatbotMessages.scrollHeight;

    // Show typing indicator
    const typingIndicator = document.createElement('div');
    typingIndicator.className = 'typing-indicator';
    typingIndicator.innerHTML = '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
    chatbotMessages.appendChild(typingIndicator);
    chatbotMessages.scrollTop = chatbotMessages.scrollHeight;

    // Get appropriate response and reply after delay
    setTimeout(() => {
        // Remove typing indicator
        typingIndicator.remove();

        // Add bot response
        const botMessage = document.createElement('div');
        botMessage.className = 'message bot-message';
        
        // Get intelligent response
        const response = getAppropriateResponse(message);
        botMessage.textContent = response;
        
        chatbotMessages.appendChild(botMessage);
        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
    }, 1000 + Math.random() * 500); // Random delay between 1-1.5 seconds
}

// Send message on button click
sendButton.addEventListener('click', sendChatbotMessage);

// Send message on Enter key
chatbotInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        sendChatbotMessage();
    }
});

// Add a welcome message if chat is empty
if (chatbotMessages.children.length <= 2) { // Only has the initial messages
    setTimeout(() => {
        const welcomeMsg = document.createElement('div');
        welcomeMsg.className = 'message bot-message';
        welcomeMsg.textContent = "Need help with library analytics or book data? I have access to the dashboard information!";
        chatbotMessages.appendChild(welcomeMsg);
    }, 2000);
}

        // Send message on button click
        sendButton.addEventListener('click', sendChatbotMessage);

        // Send message on Enter key
        chatbotInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendChatbotMessage();
            }
        });
    </script>
    <script src="nav.js"></script>
</body>

</html>
